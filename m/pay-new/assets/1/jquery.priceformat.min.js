(function(n){typeof define=="function"&&define.amd?define(["jquery"],n):typeof exports!="undefined"?module.exports=n(require("jquery")):n(jQuery)})(function(n){"use strict";n.fn.priceFormat=function(t){var t=n.extend(!0,{},n.fn.priceFormat.defaults,t),i;return window.ctrl_down=!1,i=!1,n(window).bind("keyup keydown",function(n){return window.ctrl_down=n.ctrlKey,!0}),n(this).bind("keyup keydown",function(n){return i=n.metaKey,!0}),this.each(function(){function c(n){r.is("input")?r.val(n):r.html(n);r.trigger("pricechange")}function f(){return e=r.is("input")?r.val():r.html()}function rt(n){for(var i,t="",r=0;r<n.length;r++)i=n.charAt(r),t.length==0&&i==0&&(i=!1),i&&i.match(tt)&&(w?t.length<w&&(t=t+i):t=t+i);return t}function ut(n){while(n.length<u+1)n="0"+n;return n}function a(t,i){var e,c,p,w;if(!i&&(t===""||t==a("0",!0))&&d)return"";var r=ut(rt(t)),f="",b=0;if(u==0&&(h="",e=""),e=r.substr(r.length-u,u),c=r.substr(0,r.length-u),r=it?c+h+e:c!=="0"?c+h+e:h+e,l||n.trim(l)!=""){for(p=c.length;p>0;p--)w=c.substr(p-1,1),b++,b%3==0&&(w=l+w),f=w+f;f.substr(0,1)==l&&(f=f.substring(1,f.length));r=u==0?f:f+h+e}return v&&(c!=0||e!=0)&&(r=t.indexOf("-")!=-1&&t.indexOf("+")<t.indexOf("-")?"-"+r:y?"+"+r:""+r),o&&(r=o+r),s&&(r=r+s),r}function ft(n){var t=n.keyCode?n.keyCode:n.which,o=String.fromCharCode(t),r=!1,u=e,f=a(u+o);(t>=48&&t<=57||t>=96&&t<=105)&&(r=!0);t==192&&(r=!0);t==8&&(r=!0);t==9&&(r=!0);t==13&&(r=!0);t==46&&(r=!0);t==37&&(r=!0);t==39&&(r=!0);v&&(t==189||t==109||t==173)&&(r=!0);y&&(t==187||t==107||t==61)&&(r=!0);t>=16&&t<=20&&(r=!0);t==27&&(r=!0);t>=33&&t<=40&&(r=!0);t>=44&&t<=46&&(r=!0);(window.ctrl_down||i)&&(t==86&&(r=!0),t==67&&(r=!0),t==88&&(r=!0),t==82&&(r=!0),t==84&&(r=!0),t==76&&(r=!0),t==87&&(r=!0),t==81&&(r=!0),t==78&&(r=!0),t==65&&(r=!0));r||(n.preventDefault(),n.stopPropagation(),u!=f&&c(f))}function p(){var n=f(),t=a(n),i;n!=t&&c(t);i=a("0",!0);t==i&&n!="0"&&d&&c("")}function et(){r.val(o+f())}function ot(){r.val(f()+s)}function g(){if(n.trim(o)!=""&&b){var t=f().split(o);c(t[1])}}function nt(){if(n.trim(s)!=""&&k){var t=f().split(s);c(t[0])}}var r=n(this),e="",tt=/[0-9]/;e=r.is("input")?r.val():r.html();var o=t.prefix,s=t.suffix,h=t.centsSeparator,l=t.thousandsSeparator,w=t.limit,u=t.centsLimit,b=t.clearPrefix,k=t.clearSuffix,v=t.allowNegative,y=t.insertPlusSign,d=t.clearOnEmpty,it=t.leadingZero;y&&(v=!0);r.bind("keydown.price_format",ft);r.bind("keyup.price_format",p);r.bind("focusout.price_format",p);b&&(r.bind("focusout.price_format",function(){g()}),r.bind("focusin.price_format",function(){et()}));k&&(r.bind("focusout.price_format",function(){nt()}),r.bind("focusin.price_format",function(){ot()}));f().length>0&&(p(),g(),nt())})};n.fn.unpriceFormat=function(){return n(this).unbind(".price_format")};n.fn.unmask=function(){for(var r="",i=n(this).is("input")?n(this).val()||[]:n(this).html(),t=0;t<i.length;t++)isNaN(i[t])&&i[t]!="-"||(r+=i[t]);return r};n.fn.priceToFloat=function(){var t;return t=n(this).is("input")?n(this).val()||[]:n(this).html(),parseFloat(t.replace(/[^0-9\-\.]/g,""))};n.fn.priceFormat.defaults={prefix:"US$ ",suffix:"",centsSeparator:".",thousandsSeparator:",",limit:!1,centsLimit:2,clearPrefix:!1,clearSufix:!1,allowNegative:!1,insertPlusSign:!1,clearOnEmpty:!1,leadingZero:!0}});